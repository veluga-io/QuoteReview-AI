# 샘플 견적서 Excel 형식

이 문서는 QuoteReview AI 시스템에서 인식 가능한 견적서 Excel 파일 형식을 설명합니다.

## 파일 형식

- **지원 확장자**: `.xlsx`, `.xls`, `.xlsm`
- **최대 크기**: 100MB
- **언어**: 한글 또는 영문

## 메타데이터 섹션 (상단)

견적서 상단에 다음 정보를 키-값 형식으로 배치:

```
| 항목       | 값                    |
|------------|----------------------|
| 고객명     | 홍길동                |
| 견적번호   | Q-2026-001           |
| 견적일자   | 2026-01-18           |
| 유효기한   | 2026-02-18           |
| 통화       | KRW                  |
```

**또는 영문:**

```
| Field            | Value        |
|------------------|--------------|
| Customer         | Hong Gildong |
| Quote Number     | Q-2026-001   |
| Quote Date       | 2026-01-18   |
| Valid Until      | 2026-02-18   |
| Currency         | KRW          |
```

## 라인 항목 테이블

헤더 행을 포함한 테이블 형식:

```
| 품목          | 수량 | 단가    | 금액     |
|---------------|------|---------|----------|
| 제품 A        | 10   | 50000   | 500000   |
| 서비스 B      | 5    | 100000  | 500000   |
| 부품 C        | 20   | 25000   | 500000   |
```

**또는 영문:**

```
| Description   | Quantity | Unit Price | Total    |
|---------------|----------|------------|----------|
| Product A     | 10       | 50000      | 500000   |
| Service B     | 5        | 100000     | 500000   |
| Part C        | 20       | 25000      | 500000   |
```

## 총액 섹션 (하단)

```
| 항목   | 금액      |
|--------|-----------|
| 소계   | 1500000   |
| 할인   | 150000    |
| 세율   | 0.1       |
| 세액   | 135000    |
| 총액   | 1485000   |
```

**또는 영문:**

```
| Item      | Amount    |
|-----------|-----------|
| Subtotal  | 1500000   |
| Discount  | 150000    |
| Tax Rate  | 0.1       |
| Tax       | 135000    |
| Total     | 1485000   |
```

## 예제: 정상 견적서

완전한 예제:

```
견적서

고객명: 홍길동
견적번호: Q-2026-001
견적일자: 2026-01-18
유효기한: 2026-02-18
통화: KRW

| 품목          | 수량 | 단가    | 금액     |
|---------------|------|---------|----------|
| 웹사이트 개발 | 1    | 5000000 | 5000000  |
| 모바일 앱 개발| 1    | 3000000 | 3000000  |
| 유지보수(1년) | 12   | 200000  | 2400000  |

소계: 10400000
할인: 400000 (약 3.8%)
세율: 0.1
세액: 1000000
총액: 11000000
```

## 예제: 오류가 있는 견적서 (검증 테스트용)

의도적으로 오류를 포함한 예제:

```
견적서

고객명: (누락)  ← 필수 항목 누락
견적번호: Q-2026-002
견적일자: 2026-02-20
유효기한: 2026-01-20  ← 날짜 논리 오류 (유효기한 < 견적일)
통화: USD

| 품목          | 수량 | 단가    | 금액     |
|---------------|------|---------|----------|
| 제품 X        | 10   | 50000   | 600000   | ← 수학 오류 (10 × 50000 ≠ 600000)
| 제품 Y        | 5    | 100000  | 500000   |

소계: 1100000
할인: 500000  ← 정책 위반 (할인율 45% > 30%)
세율: 0.1
세액: 60000   ← 수학 오류 ((1100000 - 500000) × 0.1 = 60000 ✓)
총액: 700000  ← 수학 오류 (1100000 - 500000 + 60000 = 660000)

통화: KRW  ← 일관성 오류 (메타데이터는 USD, 총액은 KRW)
```

## 검증 규칙

시스템은 다음을 자동으로 검증합니다:

### Layer 1: 결정론적 검증

1. **수학적 검증**
   - 라인 합계 = 수량 × 단가
   - 소계 = sum(라인 합계)
   - 세액 = (소계 - 할인) × 세율
   - 총액 = 소계 - 할인 + 세액

2. **필수 항목 검증**
   - 고객명
   - 견적번호
   - 최소 1개 라인 항목

3. **정책 규칙 검증**
   - 할인율 ≤ 30%

4. **일관성 검증**
   - 통화 일치
   - 유효기한 > 견적일

### Layer 2: AI 보조 검증

- 항목 설명의 명확성
- 비정상적인 가격 패턴
- 문구/오타 검토

## 테스트 시나리오

1. **정상 견적서**: 모든 검증 통과 (Pass)
2. **수학 오류**: 계산 오류 포함 (Fail)
3. **필수 항목 누락**: 고객명 누락 (Warning/Fail)
4. **정책 위반**: 할인율 50% (Warning)
5. **일관성 오류**: 날짜 논리 오류, 통화 불일치 (Warning)

## 샘플 파일 생성 방법

Excel이나 Google Sheets에서:

1. 새 스프레드시트 생성
2. 위의 형식에 따라 데이터 입력
3. `.xlsx` 형식으로 저장
4. QuoteReview AI 시스템에 업로드

## 주의사항

- 셀 병합은 피하세요 (파싱 오류 가능)
- 숫자는 숫자 형식으로 입력 (텍스트 아님)
- 날짜는 `YYYY-MM-DD` 형식 권장
- 빈 행은 자동으로 무시됩니다
